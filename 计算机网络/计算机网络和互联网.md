# 计算机网络和互联网

## 1.概论

### 1.1 什么是Internet

#### 什么是网络

- 网络

  由**节点**和**边**组成的一个与大小形状无关的东西（图？）



- 计算机网络

  节点：

  1. 主机节点（数据的*源和目标*）[由方框表示]，

  2. 数据交换节点（路由器、交换机、负载均衡设备等，数据的*中转节点*）[由圆圈表示]

  边：

  1. 接入链路*access*（方的和圆的接在一起）
  2. 骨干链路*backbone*（圆的和圆的接在一起）

  协议：支撑互联网*互操作*的*标准*



- 互联网

  以**TCP/IP**协议为主的一簇协议支撑的计算机网络

  >  **intranet（内部网）**：同样以TCP/IP协议为支撑，但是不与其他人互联，只供私人使用的计算机网络

  

  互联网的**端系统（end system/host）**：

  - 硬件设备（pc，server等所有联网计算设备）
  - 管理硬件，支持通讯的网络操作系统
  - 基于操作系统的网络应用

  他们很方

  - **交换机switch**（链路层）

  - 路由器（网络层）
  - 负载均衡设备（更高层）

  他们是圆

#### 什么是互联网

从组成的角度看：

互联网是网络的网络。

比如中国的三大运营商都有自己的网络，向用户提供服务。而三大运营商是可以通过互联设备相互通信的。中国地区的网络与其他国家也是互联的（访问受限）。

从应用进程的角度上看：

互联网是分布式应用进程和所有的向进程提供通讯服务的基础设施。（方式：API；分类：面向连接的服务，无连接的服务）（分布式应用是网络存在的基础）

#### Internet标准：

由**IETF（因特网工程任务组）**提供的**RFC文档**在官网发布。

### 1.2 什么是协议

> **协议**：对等层的实体在通讯的过程中需要遵守的规则的集合。

规则包括：

- 格式（PDU：协议数据单元）

​			包括：语法，语义

- 次序
- 动作

协议可以分为不同的层次，每个层次都有很多协议。**遵守同样协议的网络实体才能相互通信**。

### 1.3 网络边缘

按照组成类型把互联网分为三个子系统：

- 网络边缘**edge**（方的节点：主机，应用程序）
- 网络核心**core**（圆的节点：互联的路由器，网路的网络）
- 接入网和物理媒体**access**（把方的和圆的接在一起的东西）

#### C/S模式（客户-服务模式）

**由客户端向服务器发送请求。**客户端是主动的，服务器是被动的。所有的资源在服务器上，服务器等候在相应的端口等待客户端的请求。这是一个经典的**主从模式（主：服务器。从：客户端）**

问题： **CS模式的可拓展性很差**。客户端很多时，服务器的性能不够，就需要更多的服务器（服务器农场）。而且服务器一旦宕机，就寄了。达到一定阈值后断崖式下降。



#### P2P（peer to peer）对等体模式

**每个节点既是客户端，也是服务器。**这样，请求资源的客户很多，同时分发资源的节点也会很多，就不会导致巨大的拥挤。同时，还可能获得一个带宽的聚集，获得更快的服务速度。



#### 采用网络基础设施的面向连接的通讯方式

> 面向连接的通讯方式：
>
> 两个进程在通讯前打个招呼，两者为彼此的通讯做好准备，同时底层协议站（TCP，UDP实体）也要为通讯做好准备（变量设置，缓存等）。通讯的状态只在端系统中维护。

##### TCP实体提供的服务：

**可靠性**：依靠空间资源，复杂度等方式将下层不可靠的内容变成可靠内容提供给上层。

可靠包括：**不错误，不丢失，不重复，不乱序**。

**流量控制**功能：不让发送方速度太快让接收方来不及处理而丢失内容。

**拥塞控制**功能：保证在网络堵塞时和通畅时的传输质量保证和传输速度保证。

##### UDP实体提供的服务：

应用进程之间是**无连接的**。上来就发送，对方再回应。服务特点：

**没有流量控制，没有拥塞控制，不可靠**

但是它***快***啊

### 1.4 网络核心

作用：实现数据交换

核心功能：

​	路由：决定分组采用的源到目标的路径 （全局）

​	转发：将分组从路由器的输入链路转移到输出链路（局部）

#### 实现方式

##### 线路交换/电路交换（piece switch）

传统电话网是一种典型的线路交换网络。线路交换通信在通信前建立一个**两个实体之间的线路连接**。线路是**独享的**。哪怕没有通信也会占用线路资源。没有其他用户跟你抢线路带宽，性能会得到保障。

计算机的通信具有很强的突发性（浏览网页没有流量的流通，会占用线路资源），所以不适合线路交换。而且在通信前两者会耗费一个**线路建立的时间**，对于计算机而言这个时间很浪费。可靠性也不高（一个关键节点坏了就寄了）

网络资源（如带宽）会被分成**片（piece）**，分割方法有：

- 频分（FDM）
- 时分（TDM）
- 波分（WDM）
- 码分（CDMA）
- 统计多路复用（分组交换）

##### 分组交换（swap switch）

**以分组为单位用存储转发的方式进行数据交换**。主机之间的通信使用线路带宽的全部。按需使用，有更高的利用率，分组交换在经过交换节点时要把数据包全部存储，因此**延迟很高**。但是这种方式提高了**共享率**，在你没有使用下一个线路时别人也可以用。

### 1.5 接入网，物理媒介

#### 接入网

##### 住宅接入网络

1. 调制解调器（modem）（光猫）：不用额外接线，只需要使用电话线拨号上网。

2. DSL：挖掘了更高频的带宽资源，使用一部分带宽上行（1Mbps），大部分带宽下载（10Mbps），可以同时上网和打电话。

3. 线缆网络：不用额外接线，只需要使用电视线缆上网。额外接线到ISP路由器。各用户**共享**到线缆头端的接入网络。

   有线电视公司服务。

4. 家庭网络（WLAN）：无线路由器，功能繁多，种类齐全，支持局部交换

##### 企业接入网络

无线路由器-楼层交换机端口-大楼交换机-区域交换机-其他网络出口（移动电信等）

##### 无线接入网络

1. WLAN：无线局域接入

2. 无线广域（4G，5G基站）：带宽大，但是很少有杀手级应用能吃满。（高速路上跑拖拉机）

#### 物理媒体

导体性媒体：光缆，双绞线，同轴电缆等可以看见的实体，传播距离远

非导体性媒体：电磁波等看不见的实体，传播距离近，平方反比迅速衰减，但是很安全

##### 无线链路类型

- 地面微波

- LAN（wifi）固网互联
- 蜂窝（基站）移动互联
- 卫星

​		通过同步静止轨道卫星（延迟巨高）

​		星链（Xspace）低轨卫星包裹地面上方

### 1.6 Internet结构和ISP

按照网络互联设备的关系密集程度对互联网进行分类。

端系统通过接入**ISP**连接到互联网。（如移动ISP，联通ISP）不同的ISP之间也是需要互联的。现有**共数百万ISP**。

**ISP之间**的连接方式：通过*经济协约*与**global ISP**进行链接。各个**global ISP**会通过合作等方式进行**对等连接**。或者通过链接**IXP**进行相互连接。

**互联网服务提供商（ICP）**除了与ISP交易，也可以在对应的**地点**布置**数据中心机房**，用专线连接在一起，速度更快，服务价格更低。

### 1.8 丢包，分组延时，吞吐量

分组丢失发生的原因：

- 网络排队队列溢出
- 分组到达链路的速度超过了链路的输出能力

分组延时发生的原因：

- 处理延迟：节点对包的处理产生延迟（固定的）
- 排队延迟：包从队列尾到队列头的等待时间（取决于网络情况）
- 传输延迟：包在链路中的传输时间（取决于链路带宽）
- 传播延迟：介质传播时间延迟（取决于地理位置）

### 1.9 协议层次，服务类型



### 1.10 历史

