# Linux 入门

#linux #后端 #计算机基础

## 环境搭建
### Linux的使用：
- 项目开发：
	- [[JavaEE]]
	- 大数据
	- python
	- PHP
	- c/c++
	- GO
- Linux运维  **规划，优化，监控等工作**
- Linux嵌入式  

### 使用领域：
- 服务器领域  （免费高效）
- 个人桌面         (弱势)
- 嵌入式领域  （内核小，对网络支持好）（**物联网**中更加宽泛）

### 基本概述
>Linux 是一款开源免费的操作系统，以其稳定性，安全性，处理多并发等特性得到业界认可。目前很多企业级项目都布置在Linux上。
>吉祥物： 企鹅（Tux）
>Linux之父： **[Linus Torvalds]**(芬兰)，他还是Git的创作者，是世界著名黑客

Linux的主要发行版： Ubuntu，RedHAT , CentOS等
现在的Linux主要指的是Linux内核；

---
### VM 和 Linux 的安装
Virtual Machine 15.5 + CentOS7.6 
Linux 分区：
- boot分区（引导分区）约1G
- swap分区（交换分区）约内存大小一致 **可以临时充当内存**
- root分区（根分区）其他剩余部分

### VMtools的安装
VMtools可以实现windows和虚拟机的**文件共享**，在windows下更好地管理vm虚拟机。
***安装VMtools需要安装gcc***
linux的共享文件夹目录：

```
					/mnt/hgfs/
```
在实际开发中，文件的上传下载是通过网络远程连接的方式。


## Linux的文件系统

Linux的文件系统采用**层级式的树状结构**

> 在Linux中，一切皆为文件。
> （例如硬件会映射成文件。比如CPU，4个核的CPU会被映射成4个文件）
> （包括网络也是一个文件）

常用目录：
```
	/ 				根目录
	
//常用文件目录
		/bin/			存放Linux的常用指令
		/sbin/			管理员常用的指令，权限比较高
		/home/			存放普通用户的主目录（比如TOM用户就存放在这里）
		/root/			系统管理员用的目录，一般用户进不去
		/lib/			系统开机需要的最基本的动态链接共享库，类似于Windows的dll文件
		/lost+found/	存放系统非法关闭时为保存的文件
		/etc/			系统管理所需要的配置文件和子目录
		
		/user/			用户的很多程序和文件存放的目录
			/user/local/		软件的安装目标目录
			
			
		/boot/			启动Linux的一些核心文件
		/tmp/			用于存放一些临时文件
		/dev/			硬件设备管理器
		/media/			外设管理器
		/mnt/			存放用户临时挂载的文件系统
		/opt/			主机额外安装的的软件的安装文件存放的地址
		/var/			日志的存放目录
		/selinux/		保护系统安全的文件
		
//下面的文件不能动
		/proc/			虚拟目录。系统内存映射
		/srv/			存放一些服务启动后需要提取的数据
		/sys/			安装了Linux2.6内核中出现的一个新的文件系统 susfs
		
		
```

使用下面命令可以查看文件路径

	pwd				//显示当前所在目录

Linux的隐藏文件是以 **.**开头的

## 远程登陆Linux的服务器
Linux服务器是开发小组共享的，正式上线的项目**运行在公网**
使用工具： ** XShell**（用于远程登陆） ， **xftp**（用于文件上传下载）

查看虚拟机的IP网络地址：
```
		ifconfig		//查看网卡IP地址
		
		在CMD中：ping + IP地址可以尝试访问网络是否联通
```


## Vi/Vim编辑器
在Linux内部会内置Vi编辑器。

### 常用的三种模式
#### 正常模式
使用Vim打开一个档案直接进入正常模式。在这个模式中可以使用**上下左右移动光标**，可以使用**删除字符**和**删除整行**以及**复制粘贴**等文本操作。

一些操作：

	yy				//拷贝当前行
	5yy				//拷贝当前行向下的5行
	8dd				//删除当前行向下的8行
	p				//粘贴
	/ + 关键字				//查找关键字，输入 n 跳转到下一个
	G				//跳转到行末
	gg				//跳转到首行

#### 编辑模式
按下

	i ，I ，o , O , a , A , r , R 

中的任何一个字符可以进入编辑模式，一般来说按**i**即可

#### 命令行模式
在这个模式中可以提供相关指令完成**读取存盘，替换，退出Vim，显示行号**等操作
命令行模式的常用命令：

	wq				//保存退出
	q				//退出
	q!				//强制退出且不保存
	set nu			//显示行号
	set nonu		//关闭行号
	u				//撤销
	20gg			//跳转到第20行


#### 案例：使用Xshell和Vim开发一个Hello.java程序

打开Vim：

	vim Hello.java				//使用Vim编辑Hello.java文件
	i							//进入编辑模式
	输入代码
	esc							//退出编辑模式
	：  						//进入命令行模式
	wq						//存盘并退出


## Linux的基本操作命令

### 1.关机
相关命令：

	shutdown 				//关机命令		默认：1分钟后关机
		shutdown -h now/1		//设置关机时间：立刻关机/1分钟后关机
		shutdown -r now			//立刻重启
	halt					//立刻关机
	reboot					//立刻重启计算机
	sync					//内存数据同步到磁盘

不管是重启还是关闭系统，**都需要执行sync命令，将内存的数据写入磁盘中**
目前的 shutdown/reboot/halt 中均在关机前执行了 sync 命令，**小心驶得万年船**

### 2.用户管理
#### 登录与注销
登录时尽量少用root账号登陆，因为它具有最大的权限。
如果需要使用root权限，我们可以使用

	su - [username]		//切换到username用户
		su - root			//切换到root账号
这个命令来访问root账户。
从权限高的用户切换到权限低的用户**不需要密码**，反之需要。


使用

	logout					//登出命令
	exit					//也可以登出

可以切出 su 命令进入的用户，返回原来的用户。
如果已经是登录用户则会直接登出。

登录和登出操作只能在**运行级别3**下使用（不能在图形界面打开终端）

#### 增加与删除
root用户可以创建许多其他用户，每个用户**有自己的密码和权限**。
在实际使用中，需要向系统管理员申请一个账号，然后用账号的身份进入系统。

	useradd [username]		//添加一个[username]用户。
用户也是一个存储在Linux中的**文件**。这个用户的文件会存储在下面这个目录中：

								/home/username/

也可以使用下面这个命令指定目录：

	useradd -d /home/test king //在 /home/test 这个目录下创建king这个用户

为了保护用户的隐私文件，会用这个指令给用户设置密码

	passwd [username] 		//给[usermane]设置一个密码
		passwd					//给当前用户设置一个密码

删除用户的权限**只有root拥有**
删除一个用户可以使用下面命令

	userdel [username]		//删除username用户并且保留其工作记录（不删除家目录相关文件）
	userdel -r [username]	//删除username用户和其所有工作记录（删除家目录相关文件）

***删除操作一定要谨慎***


### 信息查询

	id [username]			//查询username用户的信息

通过这个命令可以查询一个用户的
- uid
- gid
- 用户组

> 例如： root用户的信息如下:
> uid: 0	
> gid：0	
> 用户组：0

查询不存在时会返回**no such user**

#### 找回root用户的密码

##### 无法进入系统时：

**不同版本找回密码操作有些许区别。 CentOS7.6为例**
在开机选择界面时输入*E*
找到 **utf-8**并在后面输入:

	init = /bin/sh

这样就进入了*单用户模式*。
之后再命令行输入：

	mount -o remount,rw /			//重置密码

之后输入密码。
然后执行命令：

	touch /.autorelabel
	exec /sbin/init

耐心等待即可

##### 进入系统后：
命令：

	passwd root			//重置root密码

---



	whoami			//查询当前登录的id

这个命令会查询**用户的登录信息**（切换无效），返回**登陆的名字，时间，登陆的IP地址**

### 用户组
类似于角色，系统可以通过用户组对**有共性（共同权限）的多个用户**进行管理

组的相关命令：

	groupadd [groupname]			//增加一个名为groupname的组
	groupdel [groupname]			//删除名为groupname的组
	useradd -g groupname username	//可以再用户创建时就给他分配组
	usermod -g groupname username	//切换用户所在的组

当没有给用户分配组的时候，用户默认自己存在一个组中，组**与用户名同名**（类似于并查集）
存放用户组的相关文件信息：
>在目录$$/etc/passwd$$文件下保存着**用户的配置文件**
>该文件每行的含义：
>用户名：口令（一般为空或者？）：用户标识号（类似uid）：组标识号（gid）：注释性描述：主目录：登录shell（）

>在目录$$/etc/shadow$$文件中保存**口令的配置文件**
>该文件每行的含义：
>用户名：加密口令：最后一次修改的时间：最小时间间隔：最大时间间隔：警告时间：不活动时间：失效时间：标志

>在目录$$/etc/group$$文件中保存**组的配置文件**，记录Linux包含组的信息
>每行含义：
>组名：口令：组标识号：组内用户列表

### Linux的其他运行指令

#### 指定运行级别
**运行级别：**
- 0：关机
- 1：单用户【找回丢失密码】
- 2：多用户状态没有网络服务
- 3：多用户状态有网络服务
- 4：系统未使用保留给用户
- 5：图形界面
- 6：系统重启

在Linux中最常用的运行级别是**3**和**5**。

#### 调整运行级别

	init [0~6]				//切换不同的运行级别

在$$/etc/inittab(centos7以前)$$ 文件中对运行级别进行了简化：
> multi-user.target：				运行级别3
> graphical.target：					运行级别5


执行以下命令也可以调整默认运行级别

	systemctl set-default [TARGET.target]			//调整默认运行级别为TARGET
	systemctl get-default							//查看默认运行级别

### 帮助指令

	man [命令或配置文件] （功能性描述）		//查看某一个命令的帮助（有汉化）
		//	按空格键可以查看未显示完的信息
		> man ls									//查看ls相关信息
	help								   //获得shell内部的帮助信息（全英文）

### 文件目录类的相关指令

```Linux
pwd									//当前工作目录的绝对路径

ls									//查看当前目录中的文件
	ls	-a			//显示当前目录下的所有文件（包括隐藏文件）
	ls	-l					//以列表的形式显示但钱目录下的文件

cd								//定位绝对路径或者相对路径
	cd ~						//定位到当前用户的home目录
	cd /									//定位到根目录
	cd ..						//定位到当前目录的上一级目录

mkdir 选项 [目录名]						//创建目录
	mkdir -p							//创建多级目录

rm 选项 [目录名]							//删除空目录
	rm -rf [目录名]			//强制删除目录（包括所有内容）
	-r：递归删除整个文件夹
	-f：强制删除不提示
	
touch [文件名]							//创建文件

cp 选项 [文件名] 源目录 目标目录		//拷贝文件
	cp -r 源目录 目标目录				//递归拷贝整个文件夹
	\cp -r 							//强制覆盖
	
mv oldNameFile newNameFile				//重命名
mv 源目录文件 新目录						//移动文件（剪切）

cat 选项 [文件名]						//查看文件
	cat -n								//显示行号
	cat -n [文件] | more		//更方便地浏览文件（管道命令）
	
echo 选项 [输出内容]						//输出内容到控制台
	通常用echo输出环境变量，如： 
	echo $HOSTNAME 						//输出主机名
	echo "Hello World"					//输出Hello World
	echo [输出内容] > [文件名]		//输出内容到指定文件（覆盖）
	echo [输出内容] >> [文件名]	//输出内容到指定文件（追加）

/**
    在命令行中的显示指令加上重定向符都会输出到文件，相当于C++中的流的概念。例如：
        ls -l > [文件]
    会将原本输出在窗口的文件列表输出到指定文件中。如果文件不存在会自动创建。
    
**/ 
	
head [文件名]							//查看文件前十行内容
	head -n 行数 [文件名]				//查看文件指定行内容
	
tail [文件名]							//查看文件末尾十行
	tail -n 行数 [文件名]			//查看文件最后指定行内容
	tail -f [文件名]				//实时监控文件变化
		退出监控 : ctrl + C			

ln -s [源文件或目录] [连接名] 	//在当前目录创建一个快捷方式

history								//查看操作历史
	history 10						//查看最近10条操作历史
	！数字							//重新执行指定编号的命令
```

>more指令是基于VI的内置的一款文本过滤器，他以全屏的方式按页显示文本文件内容。more指令中内置了若干快捷键：
>- space 翻页
>- enter 下一行
>-  q 		离开more
>- CTRL+F	向下滚动一屏
>- CTRL +B	向上滚动一屏
>- = 输出行号
>- :f 输出文件名和行号

> less指令可以用来分屏查看文件内容，与more指令相似。less指令也内置了一些快捷键：
> - space 下一页
> - pagedown 下一页
> - pageup 上一页
> - /字符串  向下搜寻字符串，n向下查找；N向上查找
> - ?字符串 向上查找字符串，与/相反
> - q 离开less程序


关于绝对路径和相对路径：
>绝对路径：从根目录开始定位
>相对路径：从当前目录开始对子文件定位



	### 时间日期类

```
date				//显示当前时间
	date +%Y			//显示当前年
	date "+%Y-m%-d% %H:%M:%S"	//年月日时分秒
```

